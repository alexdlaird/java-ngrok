<p align="center"><img alt="java-ngrok - a Java wrapper for ngrok" src="https://github.com/alexdlaird/java-ngrok/raw/main/logo.png" /></p>

[![Version](https://img.shields.io/maven-central/v/com.github.alexdlaird/java8-ngrok)](https://central.sonatype.com/artifact/com.github.alexdlaird/java8-ngrok)
[![Java Versions](https://img.shields.io/badge/Java-8+-blue)](https://central.sonatype.com/artifact/com.github.alexdlaird/java8-ngrok)
[![Coverage](https://img.shields.io/codecov/c/github/alexdlaird/java-ngrok/1.4.x)](https://codecov.io/gh/alexdlaird/java-ngrok/tree/1.4.x)
[![Build](https://img.shields.io/github/actions/workflow/status/alexdlaird/java-ngrok/build.yml?branch=1.4.x)](https://github.com/alexdlaird/java-ngrok/actions/workflows/build.yml?query=branch%3A1.4.x)
[![Docs](https://img.shields.io/badge/docs-passing-brightgreen)](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/overview-summary.html)
[![GitHub License](https://img.shields.io/github/license/alexdlaird/java-ngrok)](https://github.com/alexdlaird/java-ngrok/blob/main/LICENSE)

`java-ngrok` is a Java wrapper for `ngrok` that manages its own binary, making `ngrok` available via a convenient Java
API.

[`ngrok`](https://ngrok.com) is a reverse proxy that opens secure tunnels from public URLs to localhost. It's perfect
for rapid
development (test webhooks, demo local websites, enable SSH access), establishing ingress to external
networks and devices, building production APIs (traffic policies, OAuth, load balancing), and more. And
it's made even more powerful with native Java integration through the `java-ngrok` client.

## Installation

`java8-ngrok` is available
on [Maven Central](https://central.sonatype.com/artifact/com.github.alexdlaird/java8-ngrok).

If we want `ngrok` to be available from the command
line, [`pyngrok`](https://pyngrok.readthedocs.io/en/latest/#installation)
can be installed using `pip` to manage that for us.

## Basic Usage

### Open a Tunnel

All `ngrok` functionality is available through
the [`NgrokClient`](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/NgrokClient.html).
To open a tunnel, use
the [`connect()`](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/NgrokClient.html#connect-com.github.alexdlaird.ngrok.protocol.CreateTunnel-)
method, which returns a `Tunnel`, and this returned object has a reference to the public URL generated by `ngrok`, which
can be retrieved
with [`getPublicUrl()`](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/protocol/Tunnel.html#getPublicUrl--).

```java
final NgrokClient ngrokClient = new NgrokClient.Builder().build();

// Open a HTTP tunnel on the default port 80
// <Tunnel: "https://<public_sub>.ngrok.io" -> "http://localhost:80">
final Tunnel httpTunnel = ngrokClient.connect();

// Open a SSH tunnel
// <Tunnel: "tcp://0.tcp.ngrok.io:12345" -> "localhost:22">
final CreateTunnel sshCreateTunnel = new CreateTunnel.Builder()
    .withProto(Proto.TCP)
    .withAddr(22)
    .build();
final Tunnel sshTunnel = ngrokClient.connect(sshCreateTunnel);

// Open a named tunnel from the config file
final CreateTunnel createNamedTunnel = new CreateTunnel.Builder()
    .withName("my-config-file-tunnel")
    .build();
final Tunnel namedTunnel = ngrokClient.connect(createNamedTunnel);

// Open an Internal Endpoint that's load balanced
// <Tunnel: "https://some-endpoint.internal" -> "http://localhost:9000">
final CreateTunnel createInternalEndpoint = new CreateTunnel.Builder()
    .withAddr("9000")
    .withDomain("some-endpoint.internal")
    .withPoolingEnabled(true)
    .build();
final Tunnel internalEndpoint = ngrokClient.connect(createInternalEndpoint);
```

The [`connect()`](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/NgrokClient.html#connect-com.github.alexdlaird.ngrok.protocol.CreateTunnel-)
method can also take
a [`CreateTunnel`](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/protocol/CreateTunnel.html)
(which can be built through [its Builder](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/protocol/CreateTunnel.Builder.html))
that allows us to pass additional properties that
are supported by `ngrok` (or [`withName()`](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/protocol/CreateTunnel.Builder.html#withName-java.lang.String-)
to use a tunnel defined in `ngrok`'s config
file), [as documented here](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/NgrokClient.html#tunnel-configurations).

### `ngrok`'s API

The [`api()`](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/NgrokClient.html#api-java.util.List-) method allows us to use the local
`ngrok` agent to make requests against [the `ngrok` API](https://ngrok.com/docs/agent/cli-api/), if we
have [set an API key](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/com/github/alexdlaird/ngrok/NgrokClient.html#setApiKey-java.lang.String-).
For example, here we reserve a `ngrok` domain, then create a Cloud Endpoint with an associated traffic policy:

```java
final NgrokClient ngrokClient = new NgrokClient.Builder().build();

final String domain = "some-domain.ngrok.dev";
final ApiResponse domainResponse = ngrokClient.api(
    Stream.of("reserved-domains", "create",
        "--domain", domain).collect(Collectors.toList()));
final ApiResponse endpointResponse = ngrokClient.api(
    Stream.of("endpoints", "create",
        "--bindings", "public",
        "--url", String.format("https://%s", domain),
        "--traffic-policy-file", "policy.yml").collect(Collectors.toList()));
```

### Command Line Usage

Assuming we have also installed [`pyngrok`](https://pyngrok.readthedocs.io/en/latest/#installation), all features of
`ngrok` are available
on the command line.

```sh
ngrok http 80
```

For details on how to fully leverage `ngrok` from the command line,
see [`ngrok`'s official documentation](https://ngrok.com/docs/agent/cli/).

## Documentation

For more advanced usage, `java-ngrok`'s official documentation is available
at [https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/overview-summary.html](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.16/overview-summary.html).

### Integration Examples

- [Dropwizard](https://github.com/alexdlaird/java-ngrok-example-dropwizard/tree/java8)
- [Java TCP Server and Client](https://github.com/alexdlaird/java-ngrok-example-tcp-server-and-client/tree/java8)

### Java 8

This is the `1.4.x` branch, where a Java 8-compatible build of `java-ngrok` was previously maintained. While it is no
longer supported, it is still available through the `java8-ngrok` artifact instead on 
[Maven Central](https://central.sonatype.com/artifact/com.github.alexdlaird/java8-ngrok). It is recommended that you
upgrade to a modern version of Java and switch to the [`main`](https://github.com/alexdlaird/java-ngrok/tree/main) branch, where
you will find more information about the current version of [`java-ngrok`](https://central.sonatype.com/artifact/com.github.alexdlaird/java-ngrok).

For more details on what differs in the `java8-ngrok` dependency,
see [the "Java 8" section of the docs](https://javadoc.io/static/com.github.alexdlaird/java8-ngrok/1.4.18/overview-summary.html#java8).

## Contributing

If you would like to get involved, be sure to review
the [Contribution Guide](https://github.com/alexdlaird/java-ngrok/blob/main/CONTRIBUTING.md).

Want to contribute financially? If you've found `java-ngrok`
useful, [sponsorship](https://github.com/sponsors/alexdlaird)
would also be greatly appreciated!
